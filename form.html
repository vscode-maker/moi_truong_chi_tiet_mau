<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Phi·∫øu K·∫øt Qu·∫£ Th·ª≠ Nghi·ªám</title>
    <style>
      /* --- C·∫§U H√åNH TRANG IN --- */
      @page {
        size: A4;
        /* L·ªÅ trang in: Top-Bottom-Left-Right */
        margin: 10mm 15mm 10mm 20mm;
      }

      body {
        font-family: 'Times New Roman', Times, serif;
        font-size: 12pt;
        line-height: 1.3;
        margin: 0;
        background: #ccc; /* M√†u n·ªÅn khi xem tr√™n web */
      }

      /* Container ch√≠nh m√¥ ph·ªèng trang gi·∫•y tr√™n m√†n h√¨nh */
      .page-container {
        background: white;
        width: 210mm;
        min-height: 297mm;
        padding: 10mm 15mm 10mm 20mm; /* Padding gi·ªëng margin khi in */
        margin: 20px auto;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        box-sizing: border-box;
      }

      /* --- QUAN TR·ªåNG: C·∫§U TR√öC B·∫¢NG L·∫∂P HEADER --- */
      .main-wrapper-table {
        width: 100%;
        border-collapse: collapse;
        border: none;
      }

      /* B·∫Øt bu·ªôc thead hi·ªÉn th·ªã d·∫°ng nh√≥m header ƒë·ªÉ tr√¨nh duy·ªát hi·ªÉu c·∫ßn l·∫∑p l·∫°i */
      thead {
        display: table-header-group;
      }
      tfoot {
        display: table-footer-group;
      }

      /* Tr√°nh b·ªã ng·∫Øt trang gi·ªØa ch·ª´ng trong c√°c d√≤ng b·∫£ng con */
      tr {
        page-break-inside: avoid;
      }

      /* ·∫®n giao di·ªán web khi in */
      @media print {
        body {
          background: none;
        }
        .page-container {
          margin: 0;
          box-shadow: none;
          width: 100%;
          padding: 0; /* Khi in, @page ƒë√£ lo margin, n√™n padding v·ªÅ 0 */
        }
        .no-print {
          display: none !important;
        }

        /* ƒê·∫£m b·∫£o l·∫∑p l·∫°i header tr√™n Firefox/Chrome c≈© */
        .main-wrapper-table {
          page-break-inside: auto;
        }
        thead {
          display: table-header-group;
        }
      }

      /* --- CSS CHO C√ÅC TH√ÄNH PH·∫¶N CON (GI·ªÆ NGUY√äN) --- */
      table {
        width: 100%;
        border-collapse: collapse;
      }
      td,
      th {
        vertical-align: top;
      }

      /* 1. Brand Header */
      .brand-table {
        border-bottom: 1px solid #fff;
        margin-bottom: 5px;
      } /* M·∫πo: border tr·∫Øng ƒë·ªÉ t·∫°o kho·∫£ng c√°ch */
      .logo-cell {
        width: 80px;
        text-align: center;
        vertical-align: middle;
      }
      .logo-img {
        width: 70px;
        height: auto;
      }
      .org-name {
        font-weight: bold;
        font-size: 10pt;
        text-transform: uppercase;
        padding-left: 10px;
      }
      .org-contact {
        font-size: 10pt;
        padding-left: 20px;
      }

      /* 2. Title Box */
      .title-box-table {
        border: 1px solid black;
        margin-bottom: 10px;
      }
      .title-box-table td {
        padding: 5px;
        vertical-align: middle;
      }
      .border-right-dotted {
        border-right: 1px dotted black;
      }
      .so-pkq {
        font-size: 11pt;
        text-align: center;
        width: 20%;
      }
      .main-title {
        text-align: center;
        width: 60%;
      }
      .ky-hieu {
        font-size: 11pt;
        text-align: center;
        width: 20%;
      }

      /* 3. Info Table */
      .info-table {
        margin-bottom: 10px;
        font-size: 12pt;
      }
      .info-table td {
        padding: 3px 0;
      }
      .lbl {
        white-space: nowrap;
        width: 1px;
        padding-right: 5px;
      }
      .val {
        font-weight: bold;
      }

      /* 4. Result Table */
      .res-table {
        width: 100%;
        border: 1px solid black;
        margin-top: 5px;
        font-size: 12pt;
      }
      .res-table th,
      .res-table td {
        border: 1px solid black;
        text-align: center;
        padding: 5px;
      }
      .res-table th {
        font-weight: bold;
        background-color: #fff;
      }

      /* 5. Notes & Footer */
      .notes {
        font-size: 11pt;
        font-style: italic;
        margin-top: 10px;
        text-align: justify;
      }
      .footer-date {
        text-align: right;
        font-style: italic;
        margin-top: 15px;
        margin-bottom: 10px;
      }
      .signature-table td {
        text-align: center;
        vertical-align: top;
        padding-top: 10px;
      }
      .signature-title {
        font-weight: bold;
        display: block;
        margin-bottom: 80px;
      }
      .signature-name {
        font-weight: bold;
        display: block;
      }

      /* Button */
      .btn-print {
        position: fixed;
        top: 10px;
        right: 10px;
        padding: 10px 20px;
        background: #007bff;
        color: white;
        border: none;
        cursor: pointer;
        font-weight: bold;
        border-radius: 5px;
        z-index: 9999;
      }

      /* Kho·∫£ng tr·ªëng gi·ªØa header l·∫∑p l·∫°i v√† n·ªôi dung body */
      .header-spacer {
        height: 10px;
      }
    </style>
  </head>
  <body>
    <button class="btn-print no-print" onclick="window.print()">üñ®Ô∏è In Phi·∫øu PDF</button>

    <div class="page-container">
      <table class="main-wrapper-table">
        <thead>
          <tr>
            <td>
              <table class="brand-table">
                <tr>
                  <td class="logo-cell">
                    <img src="https://via.placeholder.com/150x150?text=LOGO" alt="Logo" class="logo-img" />
                  </td>
                  <td style="width: 40%">
                    <div class="org-name">
                      VI·ªÜN M√îI TR∆Ø·ªúNG & T√ÄI NGUY√äN<br />
                      TRUNG T√ÇM C√îNG NGH·ªÜ M√îI TR∆Ø·ªúNG<br />
                      PTN PH√ÇN T√çCH & K·ª∏ THU·∫¨T C√îNG NGH·ªÜ<br />
                      (VIMCERTS 077)
                    </div>
                  </td>
                  <td style="width: 50%">
                    <div class="org-contact">
                      Tr·ª• s·ªü ch√≠nh: 142 T√¥ Hi·∫øn Th√†nh, P.14, Q.10, Tp.HCM<br />
                      ƒê·ªãa ch·ªâ PTN: Khu ƒë√¥ th·ªã ƒêHQG, P. ƒê√¥ng H√≤a, Tp. HCM<br />
                      Tel: 028.2252.4567 - Hotline: 0799435426<br />
                      Email: ketquacefine@gmail.com
                    </div>
                  </td>
                </tr>
              </table>

              <table class="title-box-table">
                <tr>
                  <td class="so-pkq border-right-dotted">
                    <div style="text-decoration: underline; font-weight: bold">S·ªë PKQ:</div>
                    <div id="so_pkq" style="font-weight: bold; margin-top: 5px">.../2025/PKQ</div>
                  </td>
                  <td class="main-title border-right-dotted">
                    <div style="font-weight: bold; font-size: 16pt; text-transform: uppercase">
                      PHI·∫æU K·∫æT QU·∫¢ TH·ª¨ NGHI·ªÜM
                    </div>
                    <div style="font-weight: bold; font-size: 14pt">TEST REPORT</div>
                  </td>
                  <td class="ky-hieu">
                    <div style="text-decoration: underline; font-weight: bold">K√≠ hi·ªáu m·∫´u:</div>
                    <div id="ky_hieu_mau" style="font-weight: bold; margin-top: 5px">...</div>
                  </td>
                </tr>
              </table>

              <div class="header-spacer"></div>
            </td>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>
              <table class="info-table">
                <tr>
                  <td class="lbl">T√™n kh√°ch h√†ng</td>
                  <td>: <span id="khach_hang" class="val uppercase">...</span></td>
                  <td class="lbl" style="padding-left: 20px">Ng√†y nh·∫≠n m·∫´u</td>
                  <td style="width: 120px">: <span id="ngay_nhan">...</span></td>
                </tr>
                <tr>
                  <td class="lbl">ƒê·ªãa ch·ªâ</td>
                  <td>: <span id="dia_chi">...</span></td>
                  <td class="lbl" style="padding-left: 20px">Lo·∫°i m·∫´u</td>
                  <td>: <span id="loai_mau">...</span></td>
                </tr>
                <tr>
                  <td class="lbl">T√™n m·∫´u</td>
                  <td colspan="3">: <span id="ten_mau">...</span></td>
                </tr>
                <tr>
                  <td class="lbl">M√¥ t·∫£ m·∫´u</td>
                  <td colspan="3">: <span id="mo_ta_mau">...</span></td>
                </tr>
              </table>

              <table class="res-table">
                <thead>
                  <tr>
                    <th rowspan="2" style="width: 50px">TT</th>
                    <th rowspan="2">Ch·ªâ ti√™u</th>
                    <th rowspan="2" style="width: 80px">ƒê∆°n v·ªã</th>
                    <th rowspan="2" style="width: 150px">Ph∆∞∆°ng ph√°p th·ª≠</th>
                    <th>K·∫øt qu·∫£</th>
                  </tr>
                  <tr>
                    <th><span id="col_header_mau">...</span></th>
                  </tr>
                </thead>
                <tbody id="table_body">
                  <tr>
                    <td>1</td>
                    <td style="text-align: left">D·∫ßu m·ª° ƒë·ªông, th·ª±c v·∫≠t(b)</td>
                    <td>mg/L</td>
                    <td>SMEWW 5520B&F:2023</td>
                    <td>KPH(LOD=1)</td>
                  </tr>
                  <script>
                    for (let i = 2; i <= 25; i++) {
                      document.write(
                        `<tr><td>${i}</td><td style="text-align:left">Ch·ªâ ti√™u test ${i}</td><td>mg/L</td><td>ISO 12345</td><td>KPH</td></tr>`
                      );
                    }
                  </script>
                </tbody>
              </table>

              <div class="notes">
                <span style="text-decoration: underline">Ghi ch√∫:</span><br />
                1. (b)- Th√¥ng s·ªë ƒë√£ ƒë∆∞·ª£c B·ªô N√¥ng nghi·ªáp v√† M√¥i tr∆∞·ªùng c√¥ng nh·∫≠n (S·ªë hi·ªáu VIMCERTS 077);<br />
                2. KPH: Kh√¥ng ph√°t hi·ªán; LOD: Gi·ªõi h·∫°n ph√°t hi·ªán c·ªßa ph∆∞∆°ng ph√°p;<br />
                3. Th√¥ng tin t√™n kh√°ch h√†ng v√† m·∫´u th·ª≠ ƒë∆∞·ª£c ghi tr√™n phi·∫øu k·∫øt qu·∫£ n√†y theo y√™u c·∫ßu kh√°ch h√†ng;<br />
                4. C√°c k·∫øt qu·∫£ ph√¢n t√≠ch ch·ªâ c√≥ gi√° tr·ªã tr√™n m·∫´u th·ª≠/t·∫°i th·ªùi ƒëi·ªÉm ƒëo;<br />
                5. Th·ªùi gian l∆∞u m·∫´u: 7 ng√†y k·ªÉ t·ª´ ng√†y tr·∫£ k·∫øt qu·∫£ ƒë·ªëi v·ªõi m·∫´u ƒë·∫•t, n∆∞·ªõc, b√πn, ch·∫•t th·∫£i, kh√¥ng l∆∞u ƒë·ªëi
                v·ªõi m·∫´u kh√≠, vi sinh;<br />
                6. Kh√¥ng ƒë∆∞·ª£c tr√≠ch sao m·ªôt ph·∫ßn ho·∫∑c to√†n b·ªô phi·∫øu k·∫øt qu·∫£ th·ª≠ nghi·ªám n·∫øu kh√¥ng c√≥ s·ª± ƒë·ªìng √Ω c·ªßa Trung
                t√¢m C√¥ng ngh·ªá M√¥i tr∆∞·ªùng.
              </div>

              <div class="footer-date">
                Tp. H·ªì Ch√≠ Minh, ng√†y <span id="ngay">...</span> th√°ng <span id="thang">...</span> nƒÉm
                <span id="nam">...</span>
              </div>

              <table class="signature-table">
                <tr>
                  <td style="width: 33%">
                    <span class="signature-title">Ph·ª• tr√°ch k·ªπ thu·∫≠t</span>
                    <span class="signature-name">KS. Tr·∫ßn Th·ªã Ph∆∞∆°ng Linh</span>
                  </td>
                  <td style="width: 33%">
                    <span class="signature-title">Tr∆∞·ªüng ph√≤ng PTN</span>
                    <span class="signature-name">ThS. Phan Th·ªã Ho√†i Trinh</span>
                  </td>
                  <td style="width: 33%">
                    <span class="signature-title">Gi√°m ƒë·ªëc</span>
                    <span class="signature-name">TS. Nguy·ªÖn Nh∆∞ Hi·ªÉn</span>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <script>
      // --- JS LOGIC GI·ªÆ NGUY√äN NH∆Ø C≈® ---
      function getParam(key) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(key) || '';
      }

      window.onload = function () {
        document.getElementById('so_pkq').innerText = getParam('so_pkq');
        document.getElementById('ky_hieu_mau').innerText = getParam('ky_hieu_mau');
        document.getElementById('khach_hang').innerText = getParam('khach_hang');
        document.getElementById('ngay_nhan').innerText = getParam('ngay_nhan');
        document.getElementById('dia_chi').innerText = getParam('dia_chi');
        document.getElementById('loai_mau').innerText = getParam('loai_mau');
        document.getElementById('ten_mau').innerText = getParam('ten_mau');
        document.getElementById('mo_ta_mau').innerText = getParam('mo_ta_mau');
        document.getElementById('col_header_mau').innerText = getParam('ky_hieu_mau');

        const dateStr = getParam('ngay_ky');
        if (dateStr) {
          const parts = dateStr.split('/');
          if (parts.length === 3) {
            document.getElementById('ngay').innerText = parts[0];
            document.getElementById('thang').innerText = parts[1];
            document.getElementById('nam').innerText = parts[2];
          }
        }

        const jsonTable = getParam('table_data');
        if (jsonTable) {
          try {
            const data = JSON.parse(jsonTable);
            const tbody = document.getElementById('table_body');
            tbody.innerHTML = '';
            data.forEach(row => {
              const tr = document.createElement('tr');
              tr.innerHTML = `
                        <td>${row.tt}</td>
                        <td style="text-align: left;">${row.chi_tieu}</td>
                        <td>${row.don_vi}</td>
                        <td>${row.pp}</td>
                        <td>${row.kq}</td>
                    `;
              tbody.appendChild(tr);
            });
          } catch (e) {
            console.error(e);
          }
        }
      };
    </script>
  </body>
</html>
